from fastapi import APIRouter, Depends
from setezor.dependencies.uow_dependency import UOWDep
from setezor.dependencies.project import get_current_project, role_required
from setezor.services import L7VulnerabilityService
from setezor.schemas.roles import Roles

router = APIRouter(
    prefix="/l7-vulnerability",
    tags=["Resource Vulnerability"],
)

@router.put("/{id}/confirm")
async def set_status(
    uow: UOWDep,
    id: str,
    data:dict,
    project_id: str = Depends(get_current_project),
    _: bool = Depends(role_required([Roles.owner, Roles.executor]))
) -> bool:
    return await L7VulnerabilityService.set_status(uow=uow, project_id=project_id, id=id, status=data['status'])
