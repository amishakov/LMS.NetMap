
from sqlmodel import Field, Relationship
from setezor.models import IDDependent, Base
from typing import List

class L4SoftwareVulnerability(IDDependent, Base, table=True):
    __tablename__ = "l4_software_vulnerability"
    __table_args__ = {
        "comment": "Таблица предназначена для хранения уязвимостей на софте, который крутится на порту"
    }

    l4_software_id: str     = Field(foreign_key="l4_software.id", sa_column_kwargs={"comment":"Идентификатор софта на порту"})
    vulnerability_id: str   = Field(foreign_key="vulnerability.id", sa_column_kwargs={"comment":"Идентификатор уязвимости"})
    confirmed: bool             = Field(default=False, sa_column_kwargs={"comment":"Подтверждена ли уязвимость"})

    l4_software: "L4Software"   = Relationship(back_populates="vulnerabilities")
    vulnerability: "Vulnerability"  = Relationship(back_populates="l4_softwares")
    screenshots: List["L4SoftwareVulnerabilityScreenshot"] = Relationship(back_populates="l4_software_vulnerability")