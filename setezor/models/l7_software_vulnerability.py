
from sqlmodel import Field, Relationship
from setezor.models import IDDependent, Base
from typing import List

class L7SoftwareVulnerability(IDDependent, Base, table=True):
    __tablename__ = "l7_software_vulnerability"
    __table_args__ = {
        "comment": "Таблица предназначена для хранения уязвимостей на софте, который крутится на ресурсе уровня приложения"
    }

    l7_software_id: str     = Field(foreign_key="l7_software.id", sa_column_kwargs={"comment":"Идентификатор софта на ресурсе"})
    vulnerability_id: str   = Field(foreign_key="vulnerability.id", sa_column_kwargs={"comment":"Идентификатор уязвимости"})
    confirmed: bool             = Field(default=False, sa_column_kwargs={"comment":"Подтверждена ли уязвимость"})

    l7_software: "L7Software"   = Relationship(back_populates="vulnerabilities")
    vulnerability: "Vulnerability"                 = Relationship(back_populates="l7_softwares")
    screenshots: List["L7SoftwareVulnerabilityScreenshot"] = Relationship(back_populates="l7_software_vulnerability")