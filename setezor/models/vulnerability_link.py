
from sqlmodel import Field, Relationship
from setezor.models import IDDependent, Base
from typing import List

class VulnerabilityLink(IDDependent, Base, table=True):
    __tablename__ = "software_vulnerability_link"
    __table_args__ = {
        "comment": "Таблица предназначена для хранения ссылок на уязвимости"
    }

    link: str = Field(sa_column_kwargs={"comment": "Ссылка на уязвимость"})
    
    vulnerability_id: str = Field(foreign_key="software_vulnerability.id", sa_column_kwargs={"comment": "Ссылка на реализации уязвимости"})
    vulnerability: "Vulnerability" = Relationship(back_populates="links") # type: ignore