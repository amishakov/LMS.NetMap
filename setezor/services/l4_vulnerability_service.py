
from setezor.interfaces.service import IService
from setezor.unit_of_work.unit_of_work import UnitOfWork
from typing import List, Dict


class L4VulnerabilityService(IService):
    @classmethod
    async def set_status(cls, uow: UnitOfWork, id:int, status: str, project_id: str) -> List[Dict]:
        async with uow:
            status = await uow.l4_software_vulnerability.edit_one(id=id, data={"confirmed":status})
            await uow.commit()
            vuln = await uow.l4_software_vulnerability.find_one(id=id)
        return vuln.confirmed
